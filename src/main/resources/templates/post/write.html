<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<header>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="/css/layout.css">
    <script src="/js/jquery-3.7.1.min.js"></script>
    <script src="https://cdn.ckeditor.com/ckeditor5/40.2.0/classic/ckeditor.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-4bw+/aepP/YC94hEpVNVgiZdgIC5+VKNBQNGCHeKRQN+PtmoHDEXuppvnDJzQIu9" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm"
            crossorigin="anonymous"></script>
    <!--    multi-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/css/select2.min.css"/>
    <link rel="stylesheet" href="/css/select2-bootstrap-5-theme.min.css"/>
    <link rel="stylesheet" href="/css/select2-bootstrap-5-theme.rtl.min.css"/>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.0.13/dist/js/select2.full.min.js"></script>
</header>
<body>
<form action="/post/write" method="post">
<div>
    <div>
        <input type="text" placeholder="제목" class="inpTitle" name="title">
    </div>
    <div style="height: 500px">
        <textarea class="postWriteContent" id="editor" name="content"></textarea>
    </div>
</div>
<div class="underBox">
    <div class="col-3 mt-3 ">
        <input type="file" class="form-control" id="titleImg"
               placeholder="png,jpg" name=""
               accept="image/gif, image/jpeg, image/png" />
        <!-- <label for="titleImg" class="form-label"> 제품대표 이미지  </label>  -->

        <div class="preview"> </div>
    </div>
    <div class="col-3 mt-3">
        <select id="symptomOptions" name="symptom"
                data-placeholder="증상"
                class="form-select form-select-sm selectpicker"
                aria-label="Small select example" data-style="btn-primary">
            <th:block th:each="item,status:${symptom}">
                <option value="${item.symptomName}" th:text="${item.symptomName}"></option>
            </th:block>
        </select>
    </div>

    <div class="col-3 mt-3">
        <select id="materialOptions" name=""
                multiple="multiple" data-placeholder="원재료"
                class="form-select form-select-sm selectpicker"
                aria-label="Small select example" data-style="btn-primary">
            <th:block th:each="item,status:${material}">
                <option value="${item.materialName}" th:text="${item.materialName}"></option>
            </th:block>

        </select>
    </div>
</div>
    <div class="btnBox">
        <button class="postInsert" >등록</button>
        <button class="postCansel"><a>취소</a></button>
    </div>

</form>
</body>
<script>
    //ck editor
    ClassicEditor
        .create(document.querySelector('#editor'),
            {
                language: "ko",
                ckfinder:
                    {
                        uploadUrl: "../post/img-upload",
                        withCredentials: true,
                    }
            })
        .then(newEditor => {
            ckEditor = newEditor;
        })
        .catch(error => {
            console.error(error);
        });

    //multi
    $('#symptomOptions').select2({
        theme: "bootstrap-5",
        width: $(this).data('width') ? $(this).data('width') : $(this).hasClass('w-100') ? '100%' : 'style',
        placeholder: $(this).data('placeholder'),
        closeOnSelect: false,
    });
    $('#materialOptions').select2({
        theme: "bootstrap-5",
        width: $(this).data('width') ? $(this).data('width') : $(this).hasClass('w-100') ? '100%' : 'style',
        placeholder: $(this).data('placeholder'),
        closeOnSelect: false,
    });
    //사진 미리보기
    $('#titleImg').on('change', function(e){
        const file= e.target.files[0];
        const ext = file.name.substring(file.name.lastIndexOf("."));
        const reader = new FileReader();

        if(!(ext==".png"||ext==".jpg"||ext==".gif")){
            return false;
        };

        reader.onload = function(e){
            $(".preview").html(`<img src="\${e.target.result}">`);
        }
        reader.readAsDataURL(file);


    });

</script>

</html>